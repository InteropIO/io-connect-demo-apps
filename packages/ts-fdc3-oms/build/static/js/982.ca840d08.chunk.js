"use strict";(self.webpackChunkts_acme_oms=self.webpackChunkts_acme_oms||[]).push([[982],{673:function(e,n,i){var t=i(4165),l=i(5861),r=i(885),o=i(2791),a=i(3463),u=(i(7107),i(8622)),s=i(2233),c=(i(698),i(4022),i(1778),i(8748),i(9293)),d=i(7497),v=i(3816),m=i(4453),f=i(9231),x=i(6838),p=i(3123),h=i(3421),b=i(3841),g=i(6074),j=i(184),N=function(e){var n;return(null===(n=parseInt(null===e||void 0===e?void 0:e.trim(),10))||void 0===n?void 0:n.toString())===(null===e||void 0===e?void 0:e.trim())},y=function(e){return e?N(e)&&"0"!==e?"":"border-danger":""},I=function(e){return!(!e||"1"===e)};n.Z=function(e){console.log("NewOrderForm()");var n=(0,o.useState)(null),i=(0,r.Z)(n,2),C=i[0],Z=i[1],k=(0,o.useState)(""),S=(0,r.Z)(k,2),X=S[0],_=S[1],P=(0,o.useState)(null),E=(0,r.Z)(P,2),T=E[0],w=E[1],F=(0,o.useState)(),J=(0,r.Z)(F,2),q=J[0],O=J[1],z=(0,o.useState)(null),M=(0,r.Z)(z,2),D=M[0],B=M[1],G=(0,o.useState)(""),L=(0,r.Z)(G,2),Q=L[0],R=L[1],U=(0,o.useState)(null),V=(0,r.Z)(U,2),A=V[0],H=V[1],$=(0,o.useState)(void 0),K=(0,r.Z)($,2),W=K[0],Y=K[1],ee=(0,o.useState)(""),ne=(0,r.Z)(ee,2),ie=ne[0],te=ne[1],le=(0,o.useState)(!1),re=(0,r.Z)(le,2),oe=re[0],ae=re[1],ue=(0,v.b)(),se=(0,m.I)(),ce=(0,f.S)(),de=(0,x.E)(),ve=(0,p.a)(),me=(0,o.useMemo)((function(){return ue?ue.map((function(e){var n=e.ticker,i=e.bbgExchange;return{value:(0,h.cJ)(n,i),label:(0,h.cJ)(n,i),meta:{ticker:n,bbgExchange:i}}})).sort((function(e,n){return e.value<n.value?-1:1})):[]}),[ue]),fe=(0,o.useMemo)((function(){return console.log(se),se?Object.entries(se).filter((function(e){return(0,r.Z)(e,2)[1].enabled})).map((function(e){var n=(0,r.Z)(e,2);return{value:n[0],label:n[1].displayName}})):[]}),[se]),xe=(0,o.useMemo)((function(){return ce?Object.entries(ce).filter((function(e){return(0,r.Z)(e,2)[1].enabled})).map((function(e){var n=(0,r.Z)(e,2);return{value:n[0],label:n[1].displayName}})):[]}),[ce]),pe=(0,o.useMemo)((function(){return de?Object.entries(de).filter((function(e){return(0,r.Z)(e,2)[1].enabled})).map((function(e){var n=(0,r.Z)(e,2);return{value:n[0],label:n[1].displayName}})):[]}),[de]),he=(0,o.useMemo)((function(){return ve?ve.map((function(e){var n=e.clientId;return{value:n,label:n}})):[]}),[ve]),be=(0,o.useContext)(c.zq),ge=(0,o.useCallback)((function(e){var n,i;Z((null===pe||void 0===pe?void 0:pe.find((function(n){return n.value===(null===e||void 0===e?void 0:e.side)})))||null),_((null===e||void 0===e||null===(n=e.quantity)||void 0===n?void 0:n.toString())||"");var t=null===me||void 0===me?void 0:me.find((function(n){var i;return n.meta.ticker===(null===e||void 0===e||null===(i=e.instrument)||void 0===i?void 0:i.ticker)}));t?w(t):null!==e&&void 0!==e&&e.instrument?w({label:(0,h.cJ)(e.instrument.ticker,e.instrument.bbgExchange),value:(0,h.cJ)(e.instrument.ticker,e.instrument.bbgExchange),meta:e.instrument}):w(null),null!==e&&void 0!==e&&e.clientId&&O({label:null===e||void 0===e?void 0:e.clientId,value:null===e||void 0===e?void 0:e.clientId}),B(fe.find((function(n){return n.value===(null===e||void 0===e?void 0:e.orderType)}))||fe.find((function(e){return"1"===e.value}))),R((null===e||void 0===e||null===(i=e.limitPrice)||void 0===i?void 0:i.toString())||""),H(xe.find((function(n){return n.value===(null===e||void 0===e?void 0:e.timeInForce)}))||xe.find((function(e){return"0"===e.value}))),Y((null===e||void 0===e?void 0:e.expireTime)||void 0),te((null===e||void 0===e?void 0:e.comments)||"")}),[pe,me,fe,xe]),je=(0,o.useCallback)((function(e){ge(function(e,n){var i,t,l,r,o;console.log("ORDER:",e);var a=n.find((function(n){var i,t;return n.email===(null===e||void 0===e||null===(i=e.contact)||void 0===i||null===(t=i.id)||void 0===t?void 0:t.email)})),u=a?a.clientId:null===e||void 0===e||null===(i=e.contact)||void 0===i?void 0:i.name;return{side:null===e||void 0===e?void 0:e.side,quantity:null===e||void 0===e?void 0:e.quantity,orderType:null===e||void 0===e?void 0:e.orderType,limitPrice:I((null===e||void 0===e?void 0:e.orderType)||"")?null===e||void 0===e?void 0:e.limitPrice:null,timeInForce:null===e||void 0===e?void 0:e.timeInForce,expireTime:null!==e&&void 0!==e&&e.expireTime?new Date(e.expireTime):void 0,comments:null===e||void 0===e?void 0:e.notes,instrument:{ticker:null===(t=(0,h.yv)(null===e||void 0===e||null===(l=e.instrument)||void 0===l?void 0:l.id))||void 0===t?void 0:t.toUpperCase(),bbgExchange:null===(r=(0,h.HM)(null===e||void 0===e||null===(o=e.instrument)||void 0===o?void 0:o.id))||void 0===r?void 0:r.toUpperCase()},clientId:u||"",orderId:0,dateCreated:new Date,quantityFilled:0,averagePrice:0,currency:"GBX",tradeStatus:"",brokerId:""}}(e,ve))}),[ge,ve]);(0,o.useEffect)((function(){console.log("useEffect()",e.intentOrder),je(e.intentOrder)}),[e.intentOrder,je]),(0,o.useEffect)((function(){Q&&!I(D.value)&&R("")}),[D,Q]);var Ne=function(){var e=(0,l.Z)((0,t.Z)().mark((function e(){var n,i,l,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===be||void 0===be?void 0:be.contexts.get(g.F);case 2:return i=e.sent,l=new Date(Date.now()+(i.mockTimeOffset||0)),r={side:null===C||void 0===C?void 0:C.value,quantity:parseInt(X,10),orderType:null===D||void 0===D?void 0:D.value,limitPrice:parseFloat(Q),timeInForce:null===A||void 0===A?void 0:A.value,expireTime:W,comments:ie,instrument:null===T||void 0===T?void 0:T.meta,clientId:null!==(n=null===q||void 0===q?void 0:q.value)&&void 0!==n?n:"",orderId:0,dateCreated:l,quantityFilled:0,averagePrice:0,currency:"GBX",tradeStatus:"",brokerId:""},e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e,n=[];return null!==C&&void 0!==C&&C.value||n.push("Trade side not selected"),N(X)&&"0"!==X||n.push("Quantity is invalid"),null!==T&&void 0!==T&&T.value||n.push("Security Id missing"),q||n.push("Client Id missing"),null!==D&&void 0!==D&&D.value||n.push("Order type not selected"),!I(null===D||void 0===D?void 0:D.value)||Q&&N(Q)||n.push("Limit price missing"),null!==A&&void 0!==A&&A.value||n.push("Order validity not specified"),(e=null===A||void 0===A?void 0:A.value)&&"0"!==e&&"1"!==e&&"3"!==e&&"4"!==e&&!W&&n.push("Expire date/time not specified"),0===n.length?null:(0,j.jsx)(b.Z,{messages:n,onClose:function(){return ae(!1)}})},Ie=function(){var n=(0,l.Z)((0,t.Z)().mark((function n(){var i,l;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!ye()){n.next=4;break}return ae(!0),n.abrupt("return");case 4:return n.next=6,Ne();case 6:l=n.sent,null===be||void 0===be||be.interop.invoke(d.$I,{order:l}),null===(i=e.onComplete)||void 0===i||i.call(e,{action:"save"});case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Ce=I(null===D||void 0===D?void 0:D.value),Ze=Ce?y(Q):"";return(0,j.jsxs)(a.l0,{className:"",children:[(0,j.jsxs)(a.X2,{children:[(0,j.jsxs)(a.JX,{className:"nof-control-column",children:[(0,j.jsxs)(a.cw,{className:"d-flex align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"mr-3",children:"Side"}),(0,j.jsxs)(a.zx,{className:"mr-1",style:{position:"relative"},onClick:function(){Z(pe.find((function(e){return"1"===e.value}))||null)},children:["B",(0,j.jsx)("div",{className:"og-cell-side og-cell-buy"})]}),(0,j.jsxs)(a.zx,{className:"mr-1",style:{position:"relative"},onClick:function(){Z(pe.find((function(e){return"2"===e.value}))||null)},children:["S",(0,j.jsx)("div",{className:"og-cell-side og-cell-sell"})]}),(0,j.jsx)(u.ZP,{classNamePrefix:"select",className:"flex-grow-1",id:"side",name:"side",value:C,options:pe,onChange:function(e){return Z(e)}})]}),(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-xs-4 col-2 mr-3",children:"Quantity"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(a.II,{type:"text",className:y(X),id:"quantity",name:"quantity",autoComplete:"off",value:X,onChange:function(e){return _(e.target.value)}})})]}),(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-2 mr-3",children:"Security\xa0Id"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(s.Z,{classNamePrefix:"select",id:"securityId",name:"securityId",value:T,options:me,onChange:function(e){return w(e)}})})]}),(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-2 mr-3",children:"Client\xa0Id"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(u.ZP,{classNamePrefix:"select",id:"clientId",name:"clientId",value:q,options:he,onChange:function(e){O(e)}})})]})]}),(0,j.jsxs)(a.JX,{className:"nof-control-column",children:[(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-2 mr-3",children:"Order\xa0Type"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(u.ZP,{classNamePrefix:"select",id:"orderType",name:"orderType",value:D,options:fe,onChange:function(e){return B(e)}})})]}),(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-2 mr-3 "+(Ce?"":" nof-label-disabled"),children:"Limit\xa0Price"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(a.II,{className:Ze,type:"text",disabled:!Ce,id:"price",name:"price",autoComplete:"off",value:Q,onChange:function(e){return R(e.target.value)}})})]}),(0,j.jsxs)(a.X2,{className:"align-items-baseline mt-1",children:[(0,j.jsx)(a.__,{className:"nof-label col-2 mr-3",children:"Validity"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(u.ZP,{classNamePrefix:"select",id:"timeInForce",name:"timeInForce",value:A,options:xe,onChange:function(e){return H(e)}})})]})]})]}),(0,j.jsx)(a.X2,{children:"\xa0"}),(0,j.jsxs)(a.X2,{children:[(0,j.jsx)(a.__,{className:"nof-label col-1 mr-3",children:"Additional Instructions"}),(0,j.jsx)(a.JX,{className:"ml-3",children:(0,j.jsx)(a.II,{type:"textarea",className:"nof-textarea",rows:2,resize:"vertical",id:"comments",name:"comments",value:ie,onChange:function(e){return te(e.target.value)}})})]}),oe?ye():null,(0,j.jsx)(a.X2,{children:"\xa0"}),(0,j.jsxs)(a.X2,{className:"d-flex justify-content-center",children:[(0,j.jsx)(a.zx,{className:"col-2 mr-2",onClick:Ie,children:"Send"}),(0,j.jsx)(a.zx,{className:"col-2 mr-2",onClick:function(){var n;null===(n=e.onComplete)||void 0===n||n.call(e,{action:"cancel"})},children:"Cancel"}),(0,j.jsx)(a.zx,{className:"col-2",onClick:function(){return ge({})},children:"Clear"})]})]})}},3123:function(e,n,i){i.d(n,{a:function(){return a}});var t=i(885),l=i(9293),r=i(2791),o=i(7497),a=function(){var e=(0,r.useContext)(l.zq),n=(0,r.useState)([]),i=(0,t.Z)(n,2),a=i[0],u=i[1];return(0,r.useEffect)((function(){e.interop.invoke(o.SZ).then((function(e){var n;return u(null===(n=e.returned)||void 0===n?void 0:n.clients)})).catch((function(e){console.error("Failed invoking ".concat(o.SZ,". Error: "),e)}))}),[e]),a}},4453:function(e,n,i){i.d(n,{I:function(){return a}});var t=i(885),l=i(9293),r=i(2791),o=i(7497),a=function(){var e=(0,r.useContext)(l.zq),n=(0,r.useState)(),i=(0,t.Z)(n,2),a=i[0],u=i[1];return(0,r.useEffect)((function(){e.interop.invoke(o.Cj).then((function(e){return u(e.returned.orderTypes)})).catch((function(e){console.error("Failed invoking ".concat(o.Cj,". Error: "),e)}))}),[e]),a}},9231:function(e,n,i){i.d(n,{S:function(){return a}});var t=i(885),l=i(9293),r=i(2791),o=i(7497),a=function(){var e=(0,r.useContext)(l.zq),n=(0,r.useState)(),i=(0,t.Z)(n,2),a=i[0],u=i[1];return(0,r.useEffect)((function(){e.interop.invoke(o.PN).then((function(e){return u(e.returned.orderValidity)})).catch((function(e){console.error("Failed invoking ".concat(o.PN,". Error: "),e)}))}),[e]),a}}}]);
//# sourceMappingURL=982.ca840d08.chunk.js.map